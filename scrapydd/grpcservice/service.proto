syntax = "proto3";

service NodeService {
    rpc Login(LoginRequest) returns (LoginResponse);
    rpc Heartbeat(HeartbeatRequest) returns (HeartbeatResponse);
    rpc GetNextJob(GetNextJobRequest) returns (GetNextJobResponse);
    rpc GetJob(GetJobRequest) returns (GetJobResponse);
    rpc GetEgg(GetJobEggRequest) returns (GetJobEggRequest);
    rpc CompleteJob(CompleteJobRequest) returns (CompleteJobResponse);
}

message LoginRequest {

}

message Node {
    int64 id = 1;
}

message NodeSession {
    int64 id = 1;
    Node node = 2;
}

message LoginResponse {
    NodeSession node_session = 1;
}

message HeartbeatRequest{
    string session_id = 1;
    repeated string running_job_ids = 2;
}

message HeartbeatResponse{
    repeated string kill_job_ids = 1;
    bool new_job_available = 2;
}

message GetNextJobRequest {

}

message GetNextJobResponse {
    string jobId = 1;
    string figure = 2;
    bytes package = 3;
}

message GetJobRequest {

}

message GetJobResponse {

}

message GetJobEggRequest{

}

message GetJobEggResponse{

}

message CompleteJobRequest{
    string jobId = 1;
    string status = 2;
    bytes logs = 3;
    bytes items = 4;
}

message CompleteJobResponse{

}